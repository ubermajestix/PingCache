#!/opt/local/bin/ruby
# TODO make main script
require 'open-uri'
`ifconfig | grep broadcast | cut -d " " -f6 | xargs -0 ping -c2`
macs = `arp -a | cut -d" " -f4`
macs = macs.split("\n")
puts macs.inspect
puts macs.length
macs.each do |mac|  
  puts "opening http://pingcache.heroku.com/register/#{mac}"
  puts open("http://pingcache.heroku.com/register/#{mac}").read
end